
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proto2FFI Benchmark Results</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 40px;
            border-bottom: 2px solid #ddd;
            padding-bottom: 8px;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: 600;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .metric {
            display: inline-block;
            margin: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            min-width: 200px;
        }
        .metric-value {
            font-size: 32px;
            font-weight: bold;
            color: #4CAF50;
        }
        .metric-label {
            font-size: 14px;
            color: #777;
            margin-top: 5px;
        }
        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Proto2FFI Comprehensive Benchmark Results</h1>

        <div class="summary">
            <h2 style="color: white; border: none;">Summary Statistics</h2>
            <div class="metric">
                <div class="metric-value">25</div>
                <div class="metric-label">Total Benchmarks</div>
            </div>
            <div class="metric">
                <div class="metric-value">474767334</div>
                <div class="metric-label">Avg Ops/Sec</div>
            </div>
            <div class="metric">
                <div class="metric-value">169.43</div>
                <div class="metric-label">Avg Latency (ns)</div>
            </div>
            <div class="metric">
                <div class="metric-value">201508.39</div>
                <div class="metric-label">Avg Throughput (MB/s)</div>
            </div>
        </div>

        <h2>Performance by Category</h2>
        <div class="chart-container">
            <canvas id="categoryChart"></canvas>
        </div>

        <h2>Latency by Message Size</h2>
        <div class="chart-container">
            <canvas id="sizeChart"></canvas>
        </div>

        <h2>Throughput by Schema</h2>
        <div class="chart-container">
            <canvas id="throughputChart"></canvas>
        </div>

        <h2>Detailed Results</h2>
        <table>
            <thead>
                <tr>
                    <th>Benchmark</th>
                    <th>Category</th>
                    <th>Schema</th>
                    <th>Type</th>
                    <th>Size (bytes)</th>
                    <th>Ops/Sec</th>
                    <th>Latency (ns)</th>
                    <th>Throughput (MB/s)</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Post creation (large messages)</td><td>allocation</td><td>social_media</td><td>Post</td><td>5584</td><td>1768938</td><td>565.31</td><td>9420.16</td></tr><tr><td>Comment creation (medium messages)</td><td>allocation</td><td>social_media</td><td>Comment</td><td>2056</td><td>1976118</td><td>506.04</td><td>3874.68</td></tr><tr><td>Reaction batch processing (small messages)</td><td>allocation</td><td>social_media</td><td>Reaction</td><td>40</td><td>132649446</td><td>7.54</td><td>5060.17</td></tr><tr><td>NewsFeedItem SIMD scoring</td><td>simd</td><td>social_media</td><td>NewsFeedItem</td><td>56</td><td>74759368</td><td>13.38</td><td>3992.58</td></tr><tr><td>Message batch operations</td><td>allocation</td><td>social_media</td><td>Message</td><td>4040</td><td>1583048</td><td>631.69</td><td>6099.24</td></tr><tr><td>Stack allocation - small struct</td><td>memory</td><td>generic</td><td>Reaction</td><td>40</td><td>1089146654</td><td>0.92</td><td>41547.65</td></tr><tr><td>Stack allocation - medium struct</td><td>memory</td><td>generic</td><td>UserProfile</td><td>656</td><td>135910338</td><td>7.36</td><td>85026.91</td></tr><tr><td>Stack allocation - large struct</td><td>memory</td><td>generic</td><td>Post</td><td>5584</td><td>16089351</td><td>62.15</td><td>85680.90</td></tr><tr><td>Heap allocation - small</td><td>memory</td><td>generic</td><td>Reaction</td><td>40</td><td>14503894</td><td>68.95</td><td>553.28</td></tr><tr><td>Heap allocation - large</td><td>memory</td><td>generic</td><td>Post</td><td>5584</td><td>1309938</td><td>763.39</td><td>6975.83</td></tr><tr><td>Pre-allocated vector</td><td>memory</td><td>generic</td><td>u64</td><td>8</td><td>1046581676</td><td>0.96</td><td>7984.78</td></tr><tr><td>FFI call overhead - size query</td><td>ffi</td><td>generic</td><td>UserProfile</td><td>656</td><td>3432838741</td><td>0.29</td><td>2147619.45</td></tr><tr><td>FFI call overhead - alignment query</td><td>ffi</td><td>generic</td><td>UserProfile</td><td>656</td><td>3477908845</td><td>0.29</td><td>2175815.78</td></tr><tr><td>FFI roundtrip - small struct</td><td>ffi</td><td>generic</td><td>Reaction</td><td>40</td><td>65042766</td><td>15.37</td><td>2481.18</td></tr><tr><td>FFI roundtrip - large struct</td><td>ffi</td><td>generic</td><td>Post</td><td>5584</td><td>44327047</td><td>22.56</td><td>236055.59</td></tr><tr><td>Pool allocation pattern - Posts</td><td>pool</td><td>social_media</td><td>Post</td><td>5584</td><td>1907420</td><td>524.27</td><td>10157.62</td></tr><tr><td>Pool allocation pattern - Comments</td><td>pool</td><td>social_media</td><td>Comment</td><td>2056</td><td>3218628</td><td>310.69</td><td>6310.94</td></tr><tr><td>Pool reuse pattern - Reactions</td><td>pool</td><td>social_media</td><td>Reaction</td><td>40</td><td>1924001924</td><td>0.52</td><td>73394.85</td></tr><tr><td>Pool allocation pattern - Notifications</td><td>pool</td><td>social_media</td><td>Notification</td><td>304</td><td>36970627</td><td>27.05</td><td>10718.41</td></tr><tr><td>Sequential access - small structs</td><td>cache</td><td>generic</td><td>Reaction</td><td>40</td><td>48804988</td><td>20.49</td><td>1861.76</td></tr><tr><td>Random access - small structs</td><td>cache</td><td>generic</td><td>Reaction</td><td>40</td><td>282120872</td><td>3.54</td><td>10762.06</td></tr><tr><td>Sequential access - large structs</td><td>cache</td><td>generic</td><td>Post</td><td>5584</td><td>14987830</td><td>66.72</td><td>79814.95</td></tr><tr><td>Social media feed generation</td><td>throughput</td><td>social_media</td><td>NewsFeedItem</td><td>56</td><td>13259962</td><td>75.42</td><td>708.16</td></tr><tr><td>Batch post updates</td><td>throughput</td><td>social_media</td><td>Post</td><td>5584</td><td>3286600</td><td>304.27</td><td>17502.19</td></tr><tr><td>Batch comment processing</td><td>throughput</td><td>social_media</td><td>Comment</td><td>2056</td><td>4228326</td><td>236.50</td><td>8290.71</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        const results = [{"name":"Post creation (large messages)","category":"allocation","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":28265,"ops_per_sec":1768938.369161234,"latency_ns":565.31082,"throughput_mb_s":9420.158246418316,"memory_allocated_mb":266.265869140625},{"name":"Comment creation (medium messages)","category":"allocation","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":500000,"duration_micros":253021,"ops_per_sec":1976117.6303780659,"latency_ns":506.04275,"throughput_mb_s":3874.681327874473,"memory_allocated_mb":980.377197265625},{"name":"Reaction batch processing (small messages)","category":"allocation","schema":"social_media","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":7538,"ops_per_sec":132649445.8503075,"latency_ns":7.538667,"throughput_mb_s":5060.174783718395,"memory_allocated_mb":38.14697265625},{"name":"NewsFeedItem SIMD scoring","category":"simd","schema":"social_media","message_type":"NewsFeedItem","message_size_bytes":56,"operations":100000,"duration_micros":1337,"ops_per_sec":74759368.283338,"latency_ns":13.37625,"throughput_mb_s":3992.5810087842256,"memory_allocated_mb":5.340576171875},{"name":"Message batch operations","category":"allocation","schema":"social_media","message_type":"Message","message_size_bytes":4040,"operations":500000,"duration_micros":315846,"ops_per_sec":1583048.2983634959,"latency_ns":631.692666,"throughput_mb_s":6099.238515270732,"memory_allocated_mb":1926.422119140625},{"name":"Stack allocation - small struct","category":"memory","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":10000000,"duration_micros":9181,"ops_per_sec":1089146653.5969067,"latency_ns":0.91815,"throughput_mb_s":41547.6476134074,"memory_allocated_mb":381.4697265625},{"name":"Stack allocation - medium struct","category":"memory","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":1000000,"duration_micros":7357,"ops_per_sec":135910338.31888697,"latency_ns":7.357792,"throughput_mb_s":85026.91453665719,"memory_allocated_mb":625.6103515625},{"name":"Stack allocation - large struct","category":"memory","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":100000,"duration_micros":6215,"ops_per_sec":16089351.246787962,"latency_ns":62.15291,"throughput_mb_s":85680.9018726959,"memory_allocated_mb":532.53173828125},{"name":"Heap allocation - small","category":"memory","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":68947,"ops_per_sec":14503894.295618374,"latency_ns":68.947,"throughput_mb_s":553.2796591040945,"memory_allocated_mb":38.14697265625},{"name":"Heap allocation - large","category":"memory","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":38169,"ops_per_sec":1309937.8434493283,"latency_ns":763.395,"throughput_mb_s":6975.834768124627,"memory_allocated_mb":266.265869140625},{"name":"Pre-allocated vector","category":"memory","schema":"generic","message_type":"u64","message_size_bytes":8,"operations":10000000,"duration_micros":9554,"ops_per_sec":1046581675.8619332,"latency_ns":0.9554916,"throughput_mb_s":7984.7845143274935,"memory_allocated_mb":76.2939453125},{"name":"FFI call overhead - size query","category":"ffi","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":10000000,"duration_micros":2913,"ops_per_sec":3432838741.3702726,"latency_ns":0.2913041,"throughput_mb_s":2147619.4518460263,"memory_allocated_mb":6256.103515625},{"name":"FFI call overhead - alignment query","category":"ffi","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":10000000,"duration_micros":2875,"ops_per_sec":3477908844.704762,"latency_ns":0.2875291,"throughput_mb_s":2175815.7750380747,"memory_allocated_mb":6256.103515625},{"name":"FFI roundtrip - small struct","category":"ffi","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":15374,"ops_per_sec":65042765.6183941,"latency_ns":15.3745,"throughput_mb_s":2481.1846015317574,"memory_allocated_mb":38.14697265625},{"name":"FFI roundtrip - large struct","category":"ffi","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":100000,"duration_micros":2255,"ops_per_sec":44327046.72381014,"latency_ns":22.55959,"throughput_mb_s":236055.592447048,"memory_allocated_mb":532.53173828125},{"name":"Pool allocation pattern - Posts","category":"pool","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":26213,"ops_per_sec":1907420.1581579389,"latency_ns":524.26834,"throughput_mb_s":10157.61772456544,"memory_allocated_mb":266.265869140625},{"name":"Pool allocation pattern - Comments","category":"pool","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":500000,"duration_micros":155345,"ops_per_sec":3218627.6867164704,"latency_ns":310.691418,"throughput_mb_s":6310.938381089271,"memory_allocated_mb":980.377197265625},{"name":"Pool reuse pattern - Reactions","category":"pool","schema":"social_media","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":519,"ops_per_sec":1924001924.0019238,"latency_ns":0.51975,"throughput_mb_s":73394.84878547378,"memory_allocated_mb":38.14697265625},{"name":"Pool allocation pattern - Notifications","category":"pool","schema":"social_media","message_type":"Notification","message_size_bytes":304,"operations":500000,"duration_micros":13524,"ops_per_sec":36970626.83697802,"latency_ns":27.0485,"throughput_mb_s":10718.412931863135,"memory_allocated_mb":144.95849609375},{"name":"Sequential access - small structs","category":"cache","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":20489,"ops_per_sec":48804987.908808276,"latency_ns":20.489709,"throughput_mb_s":1861.762539245921,"memory_allocated_mb":38.14697265625},{"name":"Random access - small structs","category":"cache","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":100000,"duration_micros":354,"ops_per_sec":282120871.8663424,"latency_ns":3.54458,"throughput_mb_s":10762.057184842775,"memory_allocated_mb":3.814697265625},{"name":"Sequential access - large structs","category":"cache","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":10000,"duration_micros":667,"ops_per_sec":14987829.882135706,"latency_ns":66.7208,"throughput_mb_s":79814.9510019739,"memory_allocated_mb":53.253173828125},{"name":"Social media feed generation","category":"throughput","schema":"social_media","message_type":"NewsFeedItem","message_size_bytes":56,"operations":100000,"duration_micros":7541,"ops_per_sec":13259961.546111517,"latency_ns":75.415,"throughput_mb_s":708.1583467314196,"memory_allocated_mb":5.340576171875},{"name":"Batch post updates","category":"throughput","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":15213,"ops_per_sec":3286599.855350167,"latency_ns":304.26582,"throughput_mb_s":17502.187340045293,"memory_allocated_mb":266.265869140625},{"name":"Batch comment processing","category":"throughput","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":200000,"duration_micros":47300,"ops_per_sec":4228326.055186166,"latency_ns":236.50021,"throughput_mb_s":8290.708894217261,"memory_allocated_mb":392.15087890625}];

        const categoryData = {};
        results.forEach(r => {
            if (!categoryData[r.category]) categoryData[r.category] = [];
            categoryData[r.category].push(r);
        });

        const categoryLabels = Object.keys(categoryData);
        const categoryAvgOps = categoryLabels.map(cat => {
            const ops = categoryData[cat].map(r => r.ops_per_sec);
            return ops.reduce((a, b) => a + b, 0) / ops.length;
        });

        new Chart(document.getElementById('categoryChart'), {
            type: 'bar',
            data: {
                labels: categoryLabels,
                datasets: [{
                    label: 'Average Ops/Sec',
                    data: categoryAvgOps,
                    backgroundColor: 'rgba(76, 175, 80, 0.6)',
                    borderColor: 'rgba(76, 175, 80, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Operations per Second' }
                    }
                }
            }
        });

        new Chart(document.getElementById('sizeChart'), {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Latency vs Size',
                    data: results.map(r => ({ x: r.message_size_bytes, y: r.latency_ns })),
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        type: 'logarithmic',
                        title: { display: true, text: 'Message Size (bytes)' }
                    },
                    y: {
                        type: 'logarithmic',
                        title: { display: true, text: 'Latency (ns)' }
                    }
                }
            }
        });

        const schemaData = {};
        results.forEach(r => {
            if (!schemaData[r.schema]) schemaData[r.schema] = [];
            schemaData[r.schema].push(r);
        });

        const schemaLabels = Object.keys(schemaData);
        const schemaAvgThroughput = schemaLabels.map(schema => {
            const throughputs = schemaData[schema].map(r => r.throughput_mb_s);
            return throughputs.reduce((a, b) => a + b, 0) / throughputs.length;
        });

        new Chart(document.getElementById('throughputChart'), {
            type: 'bar',
            data: {
                labels: schemaLabels,
                datasets: [{
                    label: 'Average Throughput (MB/s)',
                    data: schemaAvgThroughput,
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Throughput (MB/s)' }
                    }
                }
            }
        });
    </script>
</body>
</html>
