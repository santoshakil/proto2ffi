
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proto2FFI Benchmark Results</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 40px;
            border-bottom: 2px solid #ddd;
            padding-bottom: 8px;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: 600;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .metric {
            display: inline-block;
            margin: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            min-width: 200px;
        }
        .metric-value {
            font-size: 32px;
            font-weight: bold;
            color: #4CAF50;
        }
        .metric-label {
            font-size: 14px;
            color: #777;
            margin-top: 5px;
        }
        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Proto2FFI Comprehensive Benchmark Results</h1>

        <div class="summary">
            <h2 style="color: white; border: none;">Summary Statistics</h2>
            <div class="metric">
                <div class="metric-value">25</div>
                <div class="metric-label">Total Benchmarks</div>
            </div>
            <div class="metric">
                <div class="metric-value">216842362</div>
                <div class="metric-label">Avg Ops/Sec</div>
            </div>
            <div class="metric">
                <div class="metric-value">4681.71</div>
                <div class="metric-label">Avg Latency (ns)</div>
            </div>
            <div class="metric">
                <div class="metric-value">94742.10</div>
                <div class="metric-label">Avg Throughput (MB/s)</div>
            </div>
        </div>

        <h2>Performance by Category</h2>
        <div class="chart-container">
            <canvas id="categoryChart"></canvas>
        </div>

        <h2>Latency by Message Size</h2>
        <div class="chart-container">
            <canvas id="sizeChart"></canvas>
        </div>

        <h2>Throughput by Schema</h2>
        <div class="chart-container">
            <canvas id="throughputChart"></canvas>
        </div>

        <h2>Detailed Results</h2>
        <table>
            <thead>
                <tr>
                    <th>Benchmark</th>
                    <th>Category</th>
                    <th>Schema</th>
                    <th>Type</th>
                    <th>Size (bytes)</th>
                    <th>Ops/Sec</th>
                    <th>Latency (ns)</th>
                    <th>Throughput (MB/s)</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Post creation (large messages)</td><td>allocation</td><td>social_media</td><td>Post</td><td>5584</td><td>290002</td><td>3448.26</td><td>1544.35</td></tr><tr><td>Comment creation (medium messages)</td><td>allocation</td><td>social_media</td><td>Comment</td><td>2056</td><td>1143018</td><td>874.88</td><td>2241.18</td></tr><tr><td>Reaction batch processing (small messages)</td><td>allocation</td><td>social_media</td><td>Reaction</td><td>40</td><td>77622425</td><td>12.88</td><td>2961.06</td></tr><tr><td>NewsFeedItem SIMD scoring</td><td>simd</td><td>social_media</td><td>NewsFeedItem</td><td>56</td><td>74220701</td><td>13.47</td><td>3963.81</td></tr><tr><td>Message batch operations</td><td>allocation</td><td>social_media</td><td>Message</td><td>4040</td><td>450876</td><td>2217.91</td><td>1737.15</td></tr><tr><td>Stack allocation - small struct</td><td>memory</td><td>generic</td><td>Reaction</td><td>40</td><td>1100019250</td><td>0.91</td><td>41962.40</td></tr><tr><td>Stack allocation - medium struct</td><td>memory</td><td>generic</td><td>UserProfile</td><td>656</td><td>119260584</td><td>8.38</td><td>74610.66</td></tr><tr><td>Stack allocation - large struct</td><td>memory</td><td>generic</td><td>Post</td><td>5584</td><td>15790098</td><td>63.33</td><td>84087.28</td></tr><tr><td>Heap allocation - small</td><td>memory</td><td>generic</td><td>Reaction</td><td>40</td><td>568093</td><td>1760.27</td><td>21.67</td></tr><tr><td>Heap allocation - large</td><td>memory</td><td>generic</td><td>Post</td><td>5584</td><td>10718</td><td>93303.30</td><td>57.08</td></tr><tr><td>Pre-allocated vector</td><td>memory</td><td>generic</td><td>u64</td><td>8</td><td>191339496</td><td>5.23</td><td>1459.80</td></tr><tr><td>FFI call overhead - size query</td><td>ffi</td><td>generic</td><td>UserProfile</td><td>656</td><td>1367490137</td><td>0.73</td><td>855515.99</td></tr><tr><td>FFI call overhead - alignment query</td><td>ffi</td><td>generic</td><td>UserProfile</td><td>656</td><td>1792556410</td><td>0.56</td><td>1121441.85</td></tr><tr><td>FFI roundtrip - small struct</td><td>ffi</td><td>generic</td><td>Reaction</td><td>40</td><td>41425879</td><td>24.14</td><td>1580.27</td></tr><tr><td>FFI roundtrip - large struct</td><td>ffi</td><td>generic</td><td>Post</td><td>5584</td><td>18031553</td><td>55.46</td><td>96023.74</td></tr><tr><td>Pool allocation pattern - Posts</td><td>pool</td><td>social_media</td><td>Post</td><td>5584</td><td>324010</td><td>3086.32</td><td>1725.46</td></tr><tr><td>Pool allocation pattern - Comments</td><td>pool</td><td>social_media</td><td>Comment</td><td>2056</td><td>753061</td><td>1327.91</td><td>1476.57</td></tr><tr><td>Pool reuse pattern - Reactions</td><td>pool</td><td>social_media</td><td>Reaction</td><td>40</td><td>579612031</td><td>1.73</td><td>22110.44</td></tr><tr><td>Pool allocation pattern - Notifications</td><td>pool</td><td>social_media</td><td>Notification</td><td>304</td><td>4242587</td><td>235.71</td><td>1230.00</td></tr><tr><td>Sequential access - small structs</td><td>cache</td><td>generic</td><td>Reaction</td><td>40</td><td>9039609</td><td>110.62</td><td>344.83</td></tr><tr><td>Random access - small structs</td><td>cache</td><td>generic</td><td>Reaction</td><td>40</td><td>13258937</td><td>75.42</td><td>505.79</td></tr><tr><td>Sequential access - large structs</td><td>cache</td><td>generic</td><td>Post</td><td>5584</td><td>9155757</td><td>109.22</td><td>48757.31</td></tr><tr><td>Social media feed generation</td><td>throughput</td><td>social_media</td><td>NewsFeedItem</td><td>56</td><td>3096175</td><td>322.98</td><td>165.35</td></tr><tr><td>Batch post updates</td><td>throughput</td><td>social_media</td><td>Post</td><td>5584</td><td>108904</td><td>9182.40</td><td>579.95</td></tr><tr><td>Batch comment processing</td><td>throughput</td><td>social_media</td><td>Comment</td><td>2056</td><td>1248745</td><td>800.80</td><td>2448.48</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        const results = [{"name":"Post creation (large messages)","category":"allocation","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":172412,"ops_per_sec":290001.5442582232,"latency_ns":3448.2575,"throughput_mb_s":1544.3502646807844,"memory_allocated_mb":266.265869140625},{"name":"Comment creation (medium messages)","category":"allocation","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":500000,"duration_micros":437438,"ops_per_sec":1143017.8185047726,"latency_ns":874.877,"throughput_mb_s":2241.177210660756,"memory_allocated_mb":980.377197265625},{"name":"Reaction batch processing (small messages)","category":"allocation","schema":"social_media","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":12882,"ops_per_sec":77622425.11861676,"latency_ns":12.882875,"throughput_mb_s":2961.060528511687,"memory_allocated_mb":38.14697265625},{"name":"NewsFeedItem SIMD scoring","category":"simd","schema":"social_media","message_type":"NewsFeedItem","message_size_bytes":56,"operations":100000,"duration_micros":1347,"ops_per_sec":74220701.19265245,"latency_ns":13.47333,"throughput_mb_s":3963.8130824933405,"memory_allocated_mb":5.340576171875},{"name":"Message batch operations","category":"allocation","schema":"social_media","message_type":"Message","message_size_bytes":4040,"operations":500000,"duration_micros":1108952,"ops_per_sec":450875.75301819074,"latency_ns":2217.905916,"throughput_mb_s":1737.154047196856,"memory_allocated_mb":1926.422119140625},{"name":"Stack allocation - small struct","category":"memory","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":10000000,"duration_micros":9090,"ops_per_sec":1100019250.336881,"latency_ns":0.909075,"throughput_mb_s":41962.40426394962,"memory_allocated_mb":381.4697265625},{"name":"Stack allocation - medium struct","category":"memory","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":1000000,"duration_micros":8385,"ops_per_sec":119260584.37686345,"latency_ns":8.385,"throughput_mb_s":74610.65611955874,"memory_allocated_mb":625.6103515625},{"name":"Stack allocation - large struct","category":"memory","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":100000,"duration_micros":6333,"ops_per_sec":15790097.808602856,"latency_ns":63.33083,"throughput_mb_s":84087.28233646236,"memory_allocated_mb":532.53173828125},{"name":"Heap allocation - small","category":"memory","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":1760274,"ops_per_sec":568093.1882205107,"latency_ns":1760.274583,"throughput_mb_s":21.671035317249707,"memory_allocated_mb":38.14697265625},{"name":"Heap allocation - large","category":"memory","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":4665165,"ops_per_sec":10717.734146778546,"latency_ns":93303.30332,"throughput_mb_s":57.07533595620289,"memory_allocated_mb":266.265869140625},{"name":"Pre-allocated vector","category":"memory","schema":"generic","message_type":"u64","message_size_bytes":8,"operations":10000000,"duration_micros":52263,"ops_per_sec":191339496.05960226,"latency_ns":5.2263125,"throughput_mb_s":1459.8045048492604,"memory_allocated_mb":76.2939453125},{"name":"FFI call overhead - size query","category":"ffi","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":10000000,"duration_micros":7312,"ops_per_sec":1367490137.319257,"latency_ns":0.7312667,"throughput_mb_s":855515.9855665518,"memory_allocated_mb":6256.103515625},{"name":"FFI call overhead - alignment query","category":"ffi","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":10000000,"duration_micros":5578,"ops_per_sec":1792556409.5095117,"latency_ns":0.5578625,"throughput_mb_s":1121441.8455488584,"memory_allocated_mb":6256.103515625},{"name":"FFI roundtrip - small struct","category":"ffi","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":24139,"ops_per_sec":41425878.746452905,"latency_ns":24.1395,"throughput_mb_s":1580.2718638020672,"memory_allocated_mb":38.14697265625},{"name":"FFI roundtrip - large struct","category":"ffi","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":100000,"duration_micros":5545,"ops_per_sec":18031553.054058235,"latency_ns":55.45834,"throughput_mb_s":96023.74291788213,"memory_allocated_mb":532.53173828125},{"name":"Pool allocation pattern - Posts","category":"pool","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":154316,"ops_per_sec":324010.1213763299,"latency_ns":3086.32334,"throughput_mb_s":1725.4567315725578,"memory_allocated_mb":266.265869140625},{"name":"Pool allocation pattern - Comments","category":"pool","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":500000,"duration_micros":663956,"ops_per_sec":753060.9574605279,"latency_ns":1327.91375,"throughput_mb_s":1476.5675816906407,"memory_allocated_mb":980.377197265625},{"name":"Pool reuse pattern - Reactions","category":"pool","schema":"social_media","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":1725,"ops_per_sec":579612030.8910028,"latency_ns":1.725292,"throughput_mb_s":22110.444293632612,"memory_allocated_mb":38.14697265625},{"name":"Pool allocation pattern - Notifications","category":"pool","schema":"social_media","message_type":"Notification","message_size_bytes":304,"operations":500000,"duration_micros":117852,"ops_per_sec":4242586.874921114,"latency_ns":235.70525,"throughput_mb_s":1229.9980258712947,"memory_allocated_mb":144.95849609375},{"name":"Sequential access - small structs","category":"cache","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":110624,"ops_per_sec":9039609.308085704,"latency_ns":110.62425,"throughput_mb_s":344.8337290987284,"memory_allocated_mb":38.14697265625},{"name":"Random access - small structs","category":"cache","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":100000,"duration_micros":7542,"ops_per_sec":13258936.556386346,"latency_ns":75.42083,"throughput_mb_s":505.78829026742346,"memory_allocated_mb":3.814697265625},{"name":"Sequential access - large structs","category":"cache","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":10000,"duration_micros":1092,"ops_per_sec":9155756.819436572,"latency_ns":109.2209,"throughput_mb_s":48757.31094334967,"memory_allocated_mb":53.253173828125},{"name":"Social media feed generation","category":"throughput","schema":"social_media","message_type":"NewsFeedItem","message_size_bytes":56,"operations":100000,"duration_micros":32297,"ops_per_sec":3096174.901929434,"latency_ns":322.97917,"throughput_mb_s":165.3535790520175,"memory_allocated_mb":5.340576171875},{"name":"Batch post updates","category":"throughput","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":459119,"ops_per_sec":108904.02985488105,"latency_ns":9182.39666,"throughput_mb_s":579.9485232445295,"memory_allocated_mb":266.265869140625},{"name":"Batch comment processing","category":"throughput","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":200000,"duration_micros":160160,"ops_per_sec":1248745.4011048276,"latency_ns":800.80375,"throughput_mb_s":2448.483032866979,"memory_allocated_mb":392.15087890625}];

        const categoryData = {};
        results.forEach(r => {
            if (!categoryData[r.category]) categoryData[r.category] = [];
            categoryData[r.category].push(r);
        });

        const categoryLabels = Object.keys(categoryData);
        const categoryAvgOps = categoryLabels.map(cat => {
            const ops = categoryData[cat].map(r => r.ops_per_sec);
            return ops.reduce((a, b) => a + b, 0) / ops.length;
        });

        new Chart(document.getElementById('categoryChart'), {
            type: 'bar',
            data: {
                labels: categoryLabels,
                datasets: [{
                    label: 'Average Ops/Sec',
                    data: categoryAvgOps,
                    backgroundColor: 'rgba(76, 175, 80, 0.6)',
                    borderColor: 'rgba(76, 175, 80, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Operations per Second' }
                    }
                }
            }
        });

        new Chart(document.getElementById('sizeChart'), {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Latency vs Size',
                    data: results.map(r => ({ x: r.message_size_bytes, y: r.latency_ns })),
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        type: 'logarithmic',
                        title: { display: true, text: 'Message Size (bytes)' }
                    },
                    y: {
                        type: 'logarithmic',
                        title: { display: true, text: 'Latency (ns)' }
                    }
                }
            }
        });

        const schemaData = {};
        results.forEach(r => {
            if (!schemaData[r.schema]) schemaData[r.schema] = [];
            schemaData[r.schema].push(r);
        });

        const schemaLabels = Object.keys(schemaData);
        const schemaAvgThroughput = schemaLabels.map(schema => {
            const throughputs = schemaData[schema].map(r => r.throughput_mb_s);
            return throughputs.reduce((a, b) => a + b, 0) / throughputs.length;
        });

        new Chart(document.getElementById('throughputChart'), {
            type: 'bar',
            data: {
                labels: schemaLabels,
                datasets: [{
                    label: 'Average Throughput (MB/s)',
                    data: schemaAvgThroughput,
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Throughput (MB/s)' }
                    }
                }
            }
        });
    </script>
</body>
</html>
