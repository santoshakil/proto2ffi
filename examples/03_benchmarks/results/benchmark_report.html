
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proto2FFI Benchmark Results</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 40px;
            border-bottom: 2px solid #ddd;
            padding-bottom: 8px;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: 600;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .metric {
            display: inline-block;
            margin: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            min-width: 200px;
        }
        .metric-value {
            font-size: 32px;
            font-weight: bold;
            color: #4CAF50;
        }
        .metric-label {
            font-size: 14px;
            color: #777;
            margin-top: 5px;
        }
        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Proto2FFI Comprehensive Benchmark Results</h1>

        <div class="summary">
            <h2 style="color: white; border: none;">Summary Statistics</h2>
            <div class="metric">
                <div class="metric-value">25</div>
                <div class="metric-label">Total Benchmarks</div>
            </div>
            <div class="metric">
                <div class="metric-value">415363866</div>
                <div class="metric-label">Avg Ops/Sec</div>
            </div>
            <div class="metric">
                <div class="metric-value">609.63</div>
                <div class="metric-label">Avg Latency (ns)</div>
            </div>
            <div class="metric">
                <div class="metric-value">191169.48</div>
                <div class="metric-label">Avg Throughput (MB/s)</div>
            </div>
        </div>

        <h2>Performance by Category</h2>
        <div class="chart-container">
            <canvas id="categoryChart"></canvas>
        </div>

        <h2>Latency by Message Size</h2>
        <div class="chart-container">
            <canvas id="sizeChart"></canvas>
        </div>

        <h2>Throughput by Schema</h2>
        <div class="chart-container">
            <canvas id="throughputChart"></canvas>
        </div>

        <h2>Detailed Results</h2>
        <table>
            <thead>
                <tr>
                    <th>Benchmark</th>
                    <th>Category</th>
                    <th>Schema</th>
                    <th>Type</th>
                    <th>Size (bytes)</th>
                    <th>Ops/Sec</th>
                    <th>Latency (ns)</th>
                    <th>Throughput (MB/s)</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Post creation (large messages)</td><td>allocation</td><td>social_media</td><td>Post</td><td>5584</td><td>374163</td><td>2672.64</td><td>1992.53</td></tr><tr><td>Comment creation (medium messages)</td><td>allocation</td><td>social_media</td><td>Comment</td><td>2056</td><td>2333614</td><td>428.52</td><td>4575.64</td></tr><tr><td>Reaction batch processing (small messages)</td><td>allocation</td><td>social_media</td><td>Reaction</td><td>40</td><td>216651440</td><td>4.62</td><td>8264.60</td></tr><tr><td>NewsFeedItem SIMD scoring</td><td>simd</td><td>social_media</td><td>NewsFeedItem</td><td>56</td><td>180613979</td><td>5.54</td><td>9645.83</td></tr><tr><td>Message batch operations</td><td>allocation</td><td>social_media</td><td>Message</td><td>4040</td><td>944557</td><td>1058.70</td><td>3639.23</td></tr><tr><td>Stack allocation - small struct</td><td>memory</td><td>generic</td><td>Reaction</td><td>40</td><td>360218116</td><td>2.78</td><td>13741.23</td></tr><tr><td>Stack allocation - medium struct</td><td>memory</td><td>generic</td><td>UserProfile</td><td>656</td><td>41165533</td><td>24.29</td><td>25753.58</td></tr><tr><td>Stack allocation - large struct</td><td>memory</td><td>generic</td><td>Post</td><td>5584</td><td>19121980</td><td>52.30</td><td>101830.61</td></tr><tr><td>Heap allocation - small</td><td>memory</td><td>generic</td><td>Reaction</td><td>40</td><td>6527605</td><td>153.20</td><td>249.01</td></tr><tr><td>Heap allocation - large</td><td>memory</td><td>generic</td><td>Post</td><td>5584</td><td>165818</td><td>6030.71</td><td>883.03</td></tr><tr><td>Pre-allocated vector</td><td>memory</td><td>generic</td><td>u64</td><td>8</td><td>42902159</td><td>23.31</td><td>327.32</td></tr><tr><td>FFI call overhead - size query</td><td>ffi</td><td>generic</td><td>UserProfile</td><td>656</td><td>3565326769</td><td>0.28</td><td>2230505.33</td></tr><tr><td>FFI call overhead - alignment query</td><td>ffi</td><td>generic</td><td>UserProfile</td><td>656</td><td>3144242766</td><td>0.32</td><td>1967070.82</td></tr><tr><td>FFI roundtrip - small struct</td><td>ffi</td><td>generic</td><td>Reaction</td><td>40</td><td>7519777</td><td>132.98</td><td>286.86</td></tr><tr><td>FFI roundtrip - large struct</td><td>ffi</td><td>generic</td><td>Post</td><td>5584</td><td>28464014</td><td>35.13</td><td>151579.91</td></tr><tr><td>Pool allocation pattern - Posts</td><td>pool</td><td>social_media</td><td>Post</td><td>5584</td><td>269487</td><td>3710.76</td><td>1435.10</td></tr><tr><td>Pool allocation pattern - Comments</td><td>pool</td><td>social_media</td><td>Comment</td><td>2056</td><td>2697967</td><td>370.65</td><td>5290.05</td></tr><tr><td>Pool reuse pattern - Reactions</td><td>pool</td><td>social_media</td><td>Reaction</td><td>40</td><td>2141900937</td><td>0.47</td><td>81707.04</td></tr><tr><td>Pool allocation pattern - Notifications</td><td>pool</td><td>social_media</td><td>Notification</td><td>304</td><td>31787321</td><td>31.46</td><td>9215.68</td></tr><tr><td>Sequential access - small structs</td><td>cache</td><td>generic</td><td>Reaction</td><td>40</td><td>199403425</td><td>5.01</td><td>7606.64</td></tr><tr><td>Random access - small structs</td><td>cache</td><td>generic</td><td>Reaction</td><td>40</td><td>339942958</td><td>2.94</td><td>12967.79</td></tr><tr><td>Sequential access - large structs</td><td>cache</td><td>generic</td><td>Post</td><td>5584</td><td>18423263</td><td>54.28</td><td>98109.72</td></tr><tr><td>Social media feed generation</td><td>throughput</td><td>social_media</td><td>NewsFeedItem</td><td>56</td><td>22636172</td><td>44.18</td><td>1208.90</td></tr><tr><td>Batch post updates</td><td>throughput</td><td>social_media</td><td>Post</td><td>5584</td><td>6192653</td><td>161.48</td><td>32977.84</td></tr><tr><td>Batch comment processing</td><td>throughput</td><td>social_media</td><td>Comment</td><td>2056</td><td>4270189</td><td>234.18</td><td>8372.79</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        const results = [{"name":"Post creation (large messages)","category":"allocation","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":133631,"ops_per_sec":374162.57738149806,"latency_ns":2672.635,"throughput_mb_s":1992.5344773276188,"memory_allocated_mb":266.265869140625},{"name":"Comment creation (medium messages)","category":"allocation","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":500000,"duration_micros":214259,"ops_per_sec":2333614.2709324397,"latency_ns":428.519834,"throughput_mb_s":4575.64443687162,"memory_allocated_mb":980.377197265625},{"name":"Reaction batch processing (small messages)","category":"allocation","schema":"social_media","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":4615,"ops_per_sec":216651439.6813144,"latency_ns":4.615709,"throughput_mb_s":8264.596545460297,"memory_allocated_mb":38.14697265625},{"name":"NewsFeedItem SIMD scoring","category":"simd","schema":"social_media","message_type":"NewsFeedItem","message_size_bytes":56,"operations":100000,"duration_micros":553,"ops_per_sec":180613979.1607591,"latency_ns":5.53667,"throughput_mb_s":9645.827134134777,"memory_allocated_mb":5.340576171875},{"name":"Message batch operations","category":"allocation","schema":"social_media","message_type":"Message","message_size_bytes":4040,"operations":500000,"duration_micros":529348,"ops_per_sec":944556.5000157108,"latency_ns":1058.697918,"throughput_mb_s":3639.229068816635,"memory_allocated_mb":1926.422119140625},{"name":"Stack allocation - small struct","category":"memory","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":10000000,"duration_micros":27760,"ops_per_sec":360218116.3920928,"latency_ns":2.7760958,"throughput_mb_s":13741.230636295046,"memory_allocated_mb":381.4697265625},{"name":"Stack allocation - medium struct","category":"memory","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":1000000,"duration_micros":24292,"ops_per_sec":41165532.90614213,"latency_ns":24.292167,"throughput_mb_s":25753.58351366924,"memory_allocated_mb":625.6103515625},{"name":"Stack allocation - large struct","category":"memory","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":100000,"duration_micros":5229,"ops_per_sec":19121979.87449862,"latency_ns":52.29584,"throughput_mb_s":101830.6118194583,"memory_allocated_mb":532.53173828125},{"name":"Heap allocation - small","category":"memory","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":153195,"ops_per_sec":6527605.091798298,"latency_ns":153.195542,"throughput_mb_s":249.00837294762795,"memory_allocated_mb":38.14697265625},{"name":"Heap allocation - large","category":"memory","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":301535,"ops_per_sec":165817.86326458023,"latency_ns":6030.71334,"throughput_mb_s":883.0327496236954,"memory_allocated_mb":266.265869140625},{"name":"Pre-allocated vector","category":"memory","schema":"generic","message_type":"u64","message_size_bytes":8,"operations":10000000,"duration_micros":233088,"ops_per_sec":42902159.48019744,"latency_ns":23.30885,"throughput_mb_s":327.31750091703367,"memory_allocated_mb":76.2939453125},{"name":"FFI call overhead - size query","category":"ffi","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":10000000,"duration_micros":2804,"ops_per_sec":3565326769.3290625,"latency_ns":0.2804792,"throughput_mb_s":2230505.3335951474,"memory_allocated_mb":6256.103515625},{"name":"FFI call overhead - alignment query","category":"ffi","schema":"generic","message_type":"UserProfile","message_size_bytes":656,"operations":10000000,"duration_micros":3180,"ops_per_sec":3144242765.7262444,"latency_ns":0.3180416,"throughput_mb_s":1967070.822063843,"memory_allocated_mb":6256.103515625},{"name":"FFI roundtrip - small struct","category":"ffi","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":132982,"ops_per_sec":7519777.051243656,"latency_ns":132.982666,"throughput_mb_s":286.856729554888,"memory_allocated_mb":38.14697265625},{"name":"FFI roundtrip - large struct","category":"ffi","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":100000,"duration_micros":3513,"ops_per_sec":28464013.51699074,"latency_ns":35.13208,"throughput_mb_s":151579.90596664074,"memory_allocated_mb":532.53173828125},{"name":"Pool allocation pattern - Posts","category":"pool","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":185538,"ops_per_sec":269486.5741788744,"latency_ns":3710.76,"throughput_mb_s":1435.10153790935,"memory_allocated_mb":266.265869140625},{"name":"Pool allocation pattern - Comments","category":"pool","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":500000,"duration_micros":185324,"ops_per_sec":2697966.677413567,"latency_ns":370.6495,"throughput_mb_s":5290.050019037527,"memory_allocated_mb":980.377197265625},{"name":"Pool reuse pattern - Reactions","category":"pool","schema":"social_media","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":466,"ops_per_sec":2141900937.08166,"latency_ns":0.466875,"throughput_mb_s":81707.03647925034,"memory_allocated_mb":38.14697265625},{"name":"Pool allocation pattern - Notifications","category":"pool","schema":"social_media","message_type":"Notification","message_size_bytes":304,"operations":500000,"duration_micros":15729,"ops_per_sec":31787320.953146636,"latency_ns":31.459084,"throughput_mb_s":9215.684480434968,"memory_allocated_mb":144.95849609375},{"name":"Sequential access - small structs","category":"cache","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":1000000,"duration_micros":5014,"ops_per_sec":199403424.83358288,"latency_ns":5.014959,"throughput_mb_s":7606.636994689288,"memory_allocated_mb":38.14697265625},{"name":"Random access - small structs","category":"cache","schema":"generic","message_type":"Reaction","message_size_bytes":40,"operations":100000,"duration_micros":294,"ops_per_sec":339942957.57171947,"latency_ns":2.94167,"throughput_mb_s":12967.794707173136,"memory_allocated_mb":3.814697265625},{"name":"Sequential access - large structs","category":"cache","schema":"generic","message_type":"Post","message_size_bytes":5584,"operations":10000,"duration_micros":542,"ops_per_sec":18423263.423189733,"latency_ns":54.2792,"throughput_mb_s":98109.724955646,"memory_allocated_mb":53.253173828125},{"name":"Social media feed generation","category":"throughput","schema":"social_media","message_type":"NewsFeedItem","message_size_bytes":56,"operations":100000,"duration_micros":4417,"ops_per_sec":22636172.42244168,"latency_ns":44.17708,"throughput_mb_s":1208.9020306174605,"memory_allocated_mb":5.340576171875},{"name":"Batch post updates","category":"throughput","schema":"social_media","message_type":"Post","message_size_bytes":5584,"operations":50000,"duration_micros":8074,"ops_per_sec":6192652.937472535,"latency_ns":161.48168,"throughput_mb_s":32977.84233364738,"memory_allocated_mb":266.265869140625},{"name":"Batch comment processing","category":"throughput","schema":"social_media","message_type":"Comment","message_size_bytes":2056,"operations":200000,"duration_micros":46836,"ops_per_sec":4270189.037425517,"latency_ns":234.18167,"throughput_mb_s":8372.791920611251,"memory_allocated_mb":392.15087890625}];

        const categoryData = {};
        results.forEach(r => {
            if (!categoryData[r.category]) categoryData[r.category] = [];
            categoryData[r.category].push(r);
        });

        const categoryLabels = Object.keys(categoryData);
        const categoryAvgOps = categoryLabels.map(cat => {
            const ops = categoryData[cat].map(r => r.ops_per_sec);
            return ops.reduce((a, b) => a + b, 0) / ops.length;
        });

        new Chart(document.getElementById('categoryChart'), {
            type: 'bar',
            data: {
                labels: categoryLabels,
                datasets: [{
                    label: 'Average Ops/Sec',
                    data: categoryAvgOps,
                    backgroundColor: 'rgba(76, 175, 80, 0.6)',
                    borderColor: 'rgba(76, 175, 80, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Operations per Second' }
                    }
                }
            }
        });

        new Chart(document.getElementById('sizeChart'), {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Latency vs Size',
                    data: results.map(r => ({ x: r.message_size_bytes, y: r.latency_ns })),
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        type: 'logarithmic',
                        title: { display: true, text: 'Message Size (bytes)' }
                    },
                    y: {
                        type: 'logarithmic',
                        title: { display: true, text: 'Latency (ns)' }
                    }
                }
            }
        });

        const schemaData = {};
        results.forEach(r => {
            if (!schemaData[r.schema]) schemaData[r.schema] = [];
            schemaData[r.schema].push(r);
        });

        const schemaLabels = Object.keys(schemaData);
        const schemaAvgThroughput = schemaLabels.map(schema => {
            const throughputs = schemaData[schema].map(r => r.throughput_mb_s);
            return throughputs.reduce((a, b) => a + b, 0) / throughputs.length;
        });

        new Chart(document.getElementById('throughputChart'), {
            type: 'bar',
            data: {
                labels: schemaLabels,
                datasets: [{
                    label: 'Average Throughput (MB/s)',
                    data: schemaAvgThroughput,
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Throughput (MB/s)' }
                    }
                }
            }
        });
    </script>
</body>
</html>
