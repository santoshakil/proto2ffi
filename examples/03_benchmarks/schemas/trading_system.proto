syntax = "proto3";

package trading;

// Real-world high-frequency trading data structures

message Price {
  int64 value = 1;  // Price in smallest unit (e.g., cents)
  uint32 decimal_places = 2;
}

message OrderBook {
  option (proto2ffi.simd) = true;

  repeated Price bid_prices = 1 [(proto2ffi.max_count) = 100];
  repeated uint64 bid_volumes = 2 [(proto2ffi.max_count) = 100];
  repeated Price ask_prices = 3 [(proto2ffi.max_count) = 100];
  repeated uint64 ask_volumes = 4 [(proto2ffi.max_count) = 100];
  uint32 bid_count = 5;
  uint32 ask_count = 6;
  uint64 timestamp_micros = 7;
  string symbol = 8 [(proto2ffi.max_length) = 16];
}

enum OrderSide {
  BUY = 0;
  SELL = 1;
}

enum OrderType {
  MARKET = 0;
  LIMIT = 1;
  STOP = 2;
  STOP_LIMIT = 3;
}

enum OrderStatus {
  PENDING = 0;
  OPEN = 1;
  PARTIALLY_FILLED = 2;
  FILLED = 3;
  CANCELLED = 4;
  REJECTED = 5;
}

message Order {
  option (proto2ffi.pool_size) = 100000;

  uint64 order_id = 1;
  uint64 client_id = 2;
  string symbol = 3 [(proto2ffi.max_length) = 16];
  OrderSide side = 4;
  OrderType type = 5;
  OrderStatus status = 6;
  Price price = 7;
  uint64 quantity = 8;
  uint64 filled_quantity = 9;
  uint64 timestamp_created = 10;
  uint64 timestamp_updated = 11;
}

message Trade {
  option (proto2ffi.pool_size) = 500000;

  uint64 trade_id = 1;
  uint64 buy_order_id = 2;
  uint64 sell_order_id = 3;
  string symbol = 4 [(proto2ffi.max_length) = 16];
  Price price = 5;
  uint64 quantity = 6;
  uint64 timestamp = 7;
  uint64 buyer_id = 8;
  uint64 seller_id = 9;
}

message TickData {
  option (proto2ffi.simd) = true;

  Price price = 1;
  uint64 volume = 2;
  uint64 timestamp = 3;
  uint32 flags = 4;  // Bitflags for trade conditions
}

message OHLCV {
  Price open = 1;
  Price high = 2;
  Price low = 3;
  Price close = 4;
  uint64 volume = 5;
  uint64 timestamp_start = 6;
  uint64 timestamp_end = 7;
}

message Position {
  uint64 account_id = 1;
  string symbol = 2 [(proto2ffi.max_length) = 16];
  int64 quantity = 3;  // Signed for long/short
  Price average_price = 4;
  int64 realized_pnl = 5;
  int64 unrealized_pnl = 6;
  Price mark_price = 7;
  uint64 last_updated = 8;
}

message RiskMetrics {
  int64 total_equity = 1;
  int64 available_margin = 2;
  int64 used_margin = 3;
  float leverage = 4;
  float margin_ratio = 5;
  int64 unrealized_pnl = 6;
  int64 realized_pnl = 7;
  uint32 open_positions = 8;
}

message MarketData {
  string symbol = 1 [(proto2ffi.max_length) = 16];
  Price last_price = 2;
  Price bid_price = 3;
  Price ask_price = 4;
  uint64 volume_24h = 5;
  float price_change_24h = 6;
  uint64 timestamp = 7;
}
